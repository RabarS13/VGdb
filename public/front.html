<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Video Game webpage project</title>
 
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
    rel="stylesheet"
  />

  <link rel="stylesheet" href="css/styles.css" />
</head>
<body class="bg-dark"></body>


  <div class="container-fluid">
    <div class="row min-vh-100 flex-nowrap">
      
      
      <div class="col-auto col-md-3 col-xl-2 px-0 bg-dark d-flex flex-column">
        <a href="/" class="text-decoration-none text-white d-flex align-items-center p-3 mb-3 border-bottom">
          <span class="fs-5 fw-bold">Content</span>
        </a>
        
        <ul class="nav nav-pills flex-column mb-auto">
          <li class="nav-item">
            <a href="index.html" class="nav-link text-white active">
              Home
            </a>
          </li>
          <li>
            <a href="news.html" class="nav-link text-white">
             
              News
            </a>
          </li>
          <li>
            <a href="about.html" class="nav-link text-white ">
            
              About
            </a>
          </li>
        </ul>
        
        <div class="mt-auto text-center pb-3">
        
        </div>
      </div>
      
  
      <div class="col py-3">
        

        <header class="mb-4">
          <div class="p-5 text-white rounded">
            <h1>Video Games webpage project</h1>
           
          </div>
        </header>
        
    
        <section class="mb-4">
          <h2 class="mb-3 text-white">Featured Reviews</h2>
          
         <input type="text" id="searchBox" placeholder="Search games..." />
<button onclick="searchGame()">Search</button>
<div id="results"></div>


          <div id="authArea"></div>
<script>
  <h2>Search for Games</h2>
  <input type="text" id="searchBox" placeholder="Enter game name..." />
  <button onclick="searchGame()">Search</button>
  <div id="results"></div>

  <script>
    // Show login/logout based on token
    const authDiv = document.getElementById('authArea');
    if (localStorage.getItem('token')) {
      authDiv.innerHTML = '<button onclick="logout()">Logout</button>';
    } else {
      authDiv.innerHTML = '<a href="/login.html">Login</a> | <a href="/register.html">Register</a>';
    }

    function logout() {
      localStorage.removeItem('token');
      location.reload();
    }

    // RAWG API search function
    async function searchGame() {
      const query = document.getElementById('searchBox').value;
      const response = await fetch(`https://api.rawg.io/api/games?key=ba9c4ee9c6c64edba467c77bbc0afe3b&search=${encodeURIComponent(query)}`);
      const data = await response.json();
      const resultsDiv = document.getElementById('results');
      resultsDiv.innerHTML = '';

      data.results.forEach(game => {
        const div = document.createElement('div');
        div.innerHTML = `
          <h3>${game.name}</h3>
          <img src="${game.background_image}" width="200" />
          <p>Released: ${game.released}</p>
          <a href="https://rawg.io/games/${game.slug}" target="_blank">
            <button>View on RAWG</button>
          </a>
          <button onclick='addToFavorites(${JSON.stringify(game)})'>Add to Favorites</button>
          <hr/>
        `;
        resultsDiv.appendChild(div);
      });
    }

    // Add to user's favorite games
    async function addToFavorites(game) {
      const token = localStorage.getItem('token');
      if (!token) {
        alert("Please log in first!");
        return;
      }

      const payload = {
        gameId: game.id,
        title: game.name,
        cover: game.background_image,
        releaseDate: game.released,
        genre: game.genres.map(g => g.name)
      };

      const res = await fetch('/api/games/favorite', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': 'Bearer ' + token
        },
        body: JSON.stringify(payload)
      });

      const result = await res.json();
      alert(result.message || result.error);
    }
  </script>
</script>

          
          <div class="row row-cols-1 row-cols-md-4 g-4">
         
            <div class="col">
              <div class="card">
                <img
                  src="img/BB.png"
                  class="card-img-top"
                  alt="Game Review 1"
                />
                <div class="card-body">
                  <h5 class="card-title">BloodBorne</h5>
                  <p class="card-text">
                    A quick preview 
                  </p>
                  <a href="BB.html" class="btn btn-primary">Read More</a>
                </div>
              </div>
            </div>

          
            <div class="col">
              <div class="card">
                <img
                  src="img/ER.jpg"
                  class="card-img-top"
                  alt="Game Review 2"
                />
                <div class="card-body">
                  <h5 class="card-title">Elden Ring</h5>
                  <p class="card-text">
                    A quick preview
                  </p>
                  <a href="ER.html" class="btn btn-primary">Read More</a>
                </div>
              </div>
            </div>

           
            <div class="col">
              <div class="card">
                <img
                  src="img/DS.jpg"
                  class="card-img-top"
                  alt="Game Review 3"
                />
                <div class="card-body">
                  <h5 class="card-title">Dark Souls</h5>
                  <p class="card-text">
                    A quick preview
                  </p>
                  <a href="DS.html" class="btn btn-primary">Read More</a>
                </div>
              </div>
            </div>
          </div>
        </section>
</body>
</html>
